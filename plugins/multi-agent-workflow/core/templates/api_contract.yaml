# API Contract Template
# Use this template to define external API contracts
# Validate with: /workflows:validate <path>

version: "1.0"

api:
  name: "API Name"
  description: "Brief description of this API"
  base_path: "/api/v1"
  version: "1.0.0"

  auth:
    type: bearer    # bearer, basic, api_key, oauth2, none
    required: true

  endpoints:
    # GET endpoint example
    - path: "/resources"
      method: GET
      summary: "List all resources"
      description: |
        Returns a paginated list of resources.
        Supports filtering and sorting.
      tags:
        - resources
      auth_required: true
      parameters:
        - name: page
          in: query
          type: integer
          required: false
          default: 1
          description: "Page number"
        - name: limit
          in: query
          type: integer
          required: false
          default: 20
          description: "Items per page"
        - name: sort
          in: query
          type: string
          required: false
          default: "created_at"
          description: "Sort field"
      responses:
        "200":
          description: "List of resources"
          content_type: "application/json"
          schema:
            type: array
            items:
              $ref: "#/models/Resource"
          example:
            data:
              - id: "abc123"
                name: "Example"
                created_at: "2026-01-27T10:00:00Z"
            pagination:
              page: 1
              limit: 20
              total: 100
        "401":
          description: "Unauthorized"
        "500":
          description: "Server error"

    # GET single resource
    - path: "/resources/{id}"
      method: GET
      summary: "Get resource by ID"
      tags:
        - resources
      auth_required: true
      parameters:
        - name: id
          in: path
          type: string
          required: true
          description: "Resource ID"
      responses:
        "200":
          description: "Resource details"
          schema:
            $ref: "#/models/Resource"
        "404":
          description: "Resource not found"

    # POST create resource
    - path: "/resources"
      method: POST
      summary: "Create a new resource"
      tags:
        - resources
      auth_required: true
      request_body:
        content_type: "application/json"
        required: true
        schema:
          $ref: "#/models/CreateResource"
        example:
          name: "New Resource"
          type: "example"
          config:
            key: "value"
      responses:
        "201":
          description: "Resource created"
          schema:
            $ref: "#/models/Resource"
          headers:
            Location: "/api/v1/resources/{id}"
        "400":
          description: "Validation error"
          schema:
            $ref: "#/models/Error"
        "409":
          description: "Resource already exists"

    # PUT update resource
    - path: "/resources/{id}"
      method: PUT
      summary: "Update resource"
      tags:
        - resources
      auth_required: true
      parameters:
        - name: id
          in: path
          type: string
          required: true
      request_body:
        content_type: "application/json"
        schema:
          $ref: "#/models/UpdateResource"
      responses:
        "200":
          description: "Resource updated"
          schema:
            $ref: "#/models/Resource"
        "404":
          description: "Resource not found"
        "400":
          description: "Validation error"

    # DELETE resource
    - path: "/resources/{id}"
      method: DELETE
      summary: "Delete resource"
      tags:
        - resources
      auth_required: true
      parameters:
        - name: id
          in: path
          type: string
          required: true
      responses:
        "204":
          description: "Resource deleted"
        "404":
          description: "Resource not found"

models:
  Resource:
    type: object
    description: "A resource entity"
    properties:
      id:
        type: string
        description: "Unique identifier"
        required: true
      name:
        type: string
        description: "Resource name"
        required: true
      type:
        type: string
        description: "Resource type"
        required: false
      config:
        type: object
        description: "Resource configuration"
        required: false
      created_at:
        type: datetime
        description: "Creation timestamp"
        required: true
      updated_at:
        type: datetime
        description: "Last update timestamp"
        required: false

  CreateResource:
    type: object
    description: "Request body for creating a resource"
    properties:
      name:
        type: string
        description: "Resource name"
        required: true
        example: "My Resource"
      type:
        type: string
        description: "Resource type"
        required: false
      config:
        type: object
        description: "Optional configuration"
        required: false

  UpdateResource:
    type: object
    description: "Request body for updating a resource"
    properties:
      name:
        type: string
        required: false
      type:
        type: string
        required: false
      config:
        type: object
        required: false

  Error:
    type: object
    description: "Error response"
    properties:
      error:
        type: string
        description: "Error type"
        required: true
      message:
        type: string
        description: "Error message"
        required: true
      details:
        type: array
        description: "Detailed validation errors"
        required: false
