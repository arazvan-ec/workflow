# Architecture Profile Template
# =============================
# Generated by: /workflows:discover --setup
# Enriched by: /workflows:compound (Step 3c)
# Location: openspec/specs/architecture-profile.yaml
#
# This file describes the architecture of a specific project.
# It is detected from the codebase and enriched after each feature.
# The solid-analyzer skill reads this file to perform contextual analysis.

stack:
  language: ""                     # php | typescript | python | go | rust | java | mixed
  framework: ""                    # symfony | laravel | express | fastapi | gin | spring | next | none
  paradigm: ""                     # oop | functional | mixed
  type_system: ""                  # strong-static | strong-dynamic | weak-dynamic

architecture:
  pattern: ""                      # hexagonal | mvc | layered | clean | microservices | serverless | monolith | none
  layers: []                       # Array of {name, path, depends_on}
  # Example:
  # layers:
  #   - name: Domain
  #     path: src/Domain/
  #     depends_on: []
  #   - name: Application
  #     path: src/Application/
  #     depends_on: [Domain]
  #   - name: Infrastructure
  #     path: src/Infrastructure/
  #     depends_on: [Domain, Application]
  separation_enforced: false       # Does the project already respect layer separation?

patterns_detected:
  data_access: ""                  # repository | active-record | query-builder | data-mapper | raw-sql
  dependency_management: ""        # constructor-injection | container-autowire | service-locator | manual
  error_handling: ""               # exceptions | result-types | error-codes | mixed
  async_pattern: ""                # promises | async-await | callbacks | coroutines | channels | none
  testing_approach: ""             # tdd | test-after | minimal | none
  http_client_pattern: ""          # vendor-sdk | raw-http-client | api-platform | none
                                   # vendor-sdk: Uses Guzzle, Symfony HttpClient, etc. via vendor packages
                                   # raw-http-client: Uses curl/file_get_contents/fetch directly
                                   # api-platform: Uses API Platform or similar framework-level abstraction
  external_api_integration: ""     # acl | direct | adapter-only | none
                                   # acl: Full Anti-Corruption Layer (Port + Adapter + Mapper)
                                   # direct: Vendor SDK called directly from Application/Domain
                                   # adapter-only: Adapter exists but no domain port interface
  serialization_strategy: ""       # framework-serializer | manual-dto | transformer-strategy | mixed | none
                                   # framework-serializer: Uses Symfony Serializer, JMS, etc. with groups
                                   # manual-dto: Manual DTO mapping in controllers/services
                                   # transformer-strategy: Strategy pattern with platform-specific transformers
  multi_platform_output: ""        # strategy-per-consumer | serialization-groups | single-format | none
                                   # strategy-per-consumer: Separate DTO/Transformer per platform
                                   # serialization-groups: Framework serialization groups/profiles
                                   # single-format: One response format for all consumers
  data_aggregation_pattern: ""     # assembler | single-source | inline | none
                                   # assembler: Dedicated assembler/builder for multi-source aggregates
                                   # single-source: Each entity from a single data source
                                   # inline: Multi-source data fetched inline in services (anti-pattern)

solid_relevance:
  # Each principle has a relevance level for THIS project.
  # This avoids forcing ISP on a Go project or LSP on code without inheritance.
  srp:
    relevance: ""                  # high | medium | low
    metric: ""                     # e.g., "classes ≤200 LOC, ≤7 public methods"
    when_violated: ""              # e.g., "Extract Class, then compose"
    reference_good: ""             # path to example of good SRP in this project
  ocp:
    relevance: ""
    metric: ""                     # e.g., "no switch/if-else chains by type"
    when_violated: ""              # e.g., "Strategy pattern (project uses it in src/...)"
    reference_good: ""
  lsp:
    relevance: ""
    metric: ""                     # e.g., "overrides respect parent contract"
    when_violated: ""              # e.g., "Composition over Inheritance"
  isp:
    relevance: ""
    metric: ""                     # e.g., "interfaces ≤5 methods"
    when_violated: ""
    reference_good: ""
  dip:
    relevance: ""
    metric: ""                     # e.g., "Domain/ imports zero from Infrastructure/"
    when_violated: ""              # e.g., "Port interface in Domain, Adapter in Infrastructure"
    reference_good: ""

conventions:
  naming:
    classes: ""                    # PascalCase | camelCase | snake_case
    methods: ""
    files: ""                      # match-class-name | kebab-case | snake_case
  structure: {}                    # project-specific paths, e.g.:
  # structure:
  #   entity_path: src/Domain/Entity/
  #   usecase_path: src/Application/UseCase/
  #   repository_interface_path: src/Domain/Port/
  #   repository_impl_path: src/Infrastructure/Persistence/
  reference_files: {}              # example files for each archetype, e.g.:
  # reference_files:
  #   entity: src/Domain/Entity/Order.php
  #   value_object: src/Domain/ValueObject/Money.php
  #   usecase: src/Application/UseCase/CreateOrderUseCase.php
  #   repository_interface: src/Domain/Port/OrderRepositoryInterface.php
  #   repository_impl: src/Infrastructure/Persistence/DoctrineOrderRepository.php
  #   controller: src/Infrastructure/Http/Controller/OrderController.php
  #   http_adapter: src/Infrastructure/External/VendorApiAdapter.php
  #   response_mapper: src/Infrastructure/External/VendorResponseMapper.php
  #   provider_interface: src/Domain/Port/ContentProviderInterface.php
  #   dto_transformer: src/Application/Transformer/MobileEditorialTransformer.php
  #   data_assembler: src/Application/Assembler/EditorialAssembler.php

external_apis_consumed: []
# Example:
# external_apis_consumed:
#   - name: "Content Management API"
#     sdk: "vendor/content-cms-sdk"
#     adapter: "src/Infrastructure/External/CmsApiAdapter.php"
#     port: "src/Domain/Port/ContentProviderInterface.php"
#     acl_compliant: true
#   - name: "User Profile Service"
#     sdk: "guzzlehttp/guzzle"
#     adapter: "src/Infrastructure/External/UserProfileClient.php"
#     port: ""       # Missing! DIP violation
#     acl_compliant: false

quality_thresholds:
  # Adaptive thresholds, discovered from project averages + margin
  max_class_loc: 200
  max_public_methods: 7
  max_constructor_deps: 7
  max_interface_methods: 5
  max_files_per_simple_change: 5   # From architecture-reference.md C-BASE-01

# Enriched by /workflows:compound (Step 3c):
learned_patterns: []
# Example:
# learned_patterns:
#   - pattern: "Value Object for validated fields (Email, Money, etc.)"
#     confidence: high             # high = used 3+ times successfully
#     source_features: [user-auth, payments, order-management]

learned_antipatterns: []
# Example:
# learned_antipatterns:
#   - antipattern: "Putting hashing logic in Entity violates SRP"
#     frequency: 2
#     prevention: "Hashing, encryption, and encoding belong in Application or Infrastructure layer"
